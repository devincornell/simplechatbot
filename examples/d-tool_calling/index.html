
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://devincornell.github.io/simplechatbot/examples/d-tool_calling/">
      
      
        <link rel="prev" href="../c-structured_outputs/">
      
      
        <link rel="next" href="../f-multi-agent_example/">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.39">
    
    
      
        <title>Tool Calling - simplechatbot</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.8c3ca2c6.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#tool-calling" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="simplechatbot" class="md-header__button md-logo" aria-label="simplechatbot" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            simplechatbot
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Tool Calling
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/devincornell/simplechatbot" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    devincornell/simplechatbot
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="simplechatbot" class="md-nav__button md-logo" aria-label="simplechatbot" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    simplechatbot
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/devincornell/simplechatbot" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    devincornell/simplechatbot
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Introduction
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Examples
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Examples
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../a-overview/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    API Introduction
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../b-model_specific_chatbots/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Model-specific ChatBots
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../c-structured_outputs/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Structured Outputs
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Tool Calling
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Tool Calling
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#enabling-tools" class="md-nav__link">
    <span class="md-ellipsis">
      Enabling Tools
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#executing-tools" class="md-nav__link">
    <span class="md-ellipsis">
      Executing Tools
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#toolkits-and-tool-factories" class="md-nav__link">
    <span class="md-ellipsis">
      Toolkits and Tool Factories
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Toolkits and Tool Factories">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#toolkit-example" class="md-nav__link">
    <span class="md-ellipsis">
      ToolKit Example
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tool-factory-examples" class="md-nav__link">
    <span class="md-ellipsis">
      Tool Factory Examples
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#conclusions" class="md-nav__link">
    <span class="md-ellipsis">
      Conclusions
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../f-multi-agent_example/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Multi-agent Examples
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#enabling-tools" class="md-nav__link">
    <span class="md-ellipsis">
      Enabling Tools
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#executing-tools" class="md-nav__link">
    <span class="md-ellipsis">
      Executing Tools
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#toolkits-and-tool-factories" class="md-nav__link">
    <span class="md-ellipsis">
      Toolkits and Tool Factories
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Toolkits and Tool Factories">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#toolkit-example" class="md-nav__link">
    <span class="md-ellipsis">
      ToolKit Example
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tool-factory-examples" class="md-nav__link">
    <span class="md-ellipsis">
      Tool Factory Examples
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#conclusions" class="md-nav__link">
    <span class="md-ellipsis">
      Conclusions
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


<h1 id="tool-calling">Tool Calling</h1>
<p><code>simplechatbot</code> empowers agents with the ability to produce arguments for arbitrary user functions instead of providing a text response to the user's prompt. Using this interface you can enable features such as web searching, email sending/checking, file browsing, image creation, or any other functionality that can be accessed through Python. The LLM will "decide" whether and which tools/functions should be executed based on a given prompt, so the key is to use tools with clear and concise instructions.</p>
<p>Under the hood, <code>ChatBot</code> instances maintain a collection of <a href="https://python.langchain.com/docs/how_to/#tools">langchain tools</a> which can be extracted from toolkits or even factory methods that accept the chatbot itself as a parameter. Tools may also be added at the time of LLM execution to enable dynamic systems of available tools.</p>
<p>You can create your own <a href="https://python.langchain.com/docs/how_to/custom_tools/">custom tools</a> or choose from <a href="https://python.langchain.com/docs/integrations/tools/">Langchain's built-in tools</a>. I will use <code>FileManagementToolkit</code> for demonstration purposes here.</p>
<hr />
<div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1">1</a></span>
<span class="normal"><a href="#__codelineno-0-2">2</a></span>
<span class="normal"><a href="#__codelineno-0-3">3</a></span>
<span class="normal"><a href="#__codelineno-0-4">4</a></span>
<span class="normal"><a href="#__codelineno-0-5">5</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="kn">import</span> <span class="nn">sys</span>
<a id="__codelineno-0-2" name="__codelineno-0-2"></a><span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;../src/&#39;</span><span class="p">)</span>
<a id="__codelineno-0-3" name="__codelineno-0-3"></a>
<a id="__codelineno-0-4" name="__codelineno-0-4"></a><span class="kn">import</span> <span class="nn">simplechatbot</span>
<a id="__codelineno-0-5" name="__codelineno-0-5"></a><span class="kn">from</span> <span class="nn">simplechatbot.openai_agent</span> <span class="kn">import</span> <span class="n">OpenAIAgent</span>
</code></pre></div></td></tr></table></div>
<hr />
<h2 id="enabling-tools">Enabling Tools</h2>
<p>Start by creating a new example tool that can enables the LLM to check email for the user. We create this tool using the <code>@langchain_core.tools.tool</code> decorator.</p>
<hr />
<div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-1-1">1</a></span>
<span class="normal"><a href="#__codelineno-1-2">2</a></span>
<span class="normal"><a href="#__codelineno-1-3">3</a></span>
<span class="normal"><a href="#__codelineno-1-4">4</a></span>
<span class="normal"><a href="#__codelineno-1-5">5</a></span>
<span class="normal"><a href="#__codelineno-1-6">6</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1"></a><span class="kn">import</span> <span class="nn">langchain_core.tools</span>
<a id="__codelineno-1-2" name="__codelineno-1-2"></a>
<a id="__codelineno-1-3" name="__codelineno-1-3"></a><span class="nd">@langchain_core</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">tool</span>
<a id="__codelineno-1-4" name="__codelineno-1-4"></a><span class="k">def</span> <span class="nf">check_new_messages</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-1-5" name="__codelineno-1-5"></a><span class="w">    </span><span class="sd">&#39;&#39;&#39;Check messages.&#39;&#39;&#39;</span>
<a id="__codelineno-1-6" name="__codelineno-1-6"></a>    <span class="k">return</span> <span class="sa">f</span><span class="s1">&#39;No new messages.&#39;</span>
</code></pre></div></td></tr></table></div>
<hr />
<p>We include this tool as part of the chatbot by passing the function through the <code>tools</code> argument.</p>
<hr />
<div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-2-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-2-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-2-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-2-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-2-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-2-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-2-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-2-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-2-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-2-10">10</a></span>
<span class="normal"><a href="#__codelineno-2-11">11</a></span>
<span class="normal"><a href="#__codelineno-2-12">12</a></span>
<span class="normal"><a href="#__codelineno-2-13">13</a></span>
<span class="normal"><a href="#__codelineno-2-14">14</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1"></a><span class="n">keychain</span> <span class="o">=</span> <span class="n">simplechatbot</span><span class="o">.</span><span class="n">APIKeyChain</span><span class="o">.</span><span class="n">from_json_file</span><span class="p">(</span><span class="s1">&#39;../keys.json&#39;</span><span class="p">)</span>
<a id="__codelineno-2-2" name="__codelineno-2-2"></a>
<a id="__codelineno-2-3" name="__codelineno-2-3"></a><span class="n">system_prompt</span> <span class="o">=</span> <span class="s1">&#39;&#39;&#39;</span>
<a id="__codelineno-2-4" name="__codelineno-2-4"></a><span class="s1">You are designed to answer any question the user has and send/check messages if needed.</span>
<a id="__codelineno-2-5" name="__codelineno-2-5"></a><span class="s1">When the user requests you to check your messages, you should display the retrieved messages</span>
<a id="__codelineno-2-6" name="__codelineno-2-6"></a><span class="s1"> to the user.</span>
<a id="__codelineno-2-7" name="__codelineno-2-7"></a><span class="s1">&#39;&#39;&#39;</span>
<a id="__codelineno-2-8" name="__codelineno-2-8"></a>
<a id="__codelineno-2-9" name="__codelineno-2-9"></a><span class="n">agent</span> <span class="o">=</span> <span class="n">OpenAIAgent</span><span class="o">.</span><span class="n">new</span><span class="p">(</span>
<a id="__codelineno-2-10" name="__codelineno-2-10"></a>    <span class="n">model_name</span> <span class="o">=</span> <span class="s1">&#39;gpt-4o-mini&#39;</span><span class="p">,</span> 
<a id="__codelineno-2-11" name="__codelineno-2-11"></a>    <span class="n">api_key</span><span class="o">=</span><span class="n">keychain</span><span class="p">[</span><span class="s1">&#39;openai&#39;</span><span class="p">],</span>
<a id="__codelineno-2-12" name="__codelineno-2-12"></a>    <span class="n">system_prompt</span><span class="o">=</span><span class="n">system_prompt</span><span class="p">,</span>
<a id="__codelineno-2-13" name="__codelineno-2-13"></a>    <span class="n">tools</span> <span class="o">=</span> <span class="p">[</span><span class="n">check_new_messages</span><span class="p">],</span>
<a id="__codelineno-2-14" name="__codelineno-2-14"></a><span class="p">)</span>
</code></pre></div></td></tr></table></div>
<hr />
<p>Now the LLM will have access to these tools. While the agent instance stores the LLM object in the <code>_model</code> attribute, you can use <code>model</code> to get the LLM with bound tools.</p>
<hr />
<div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-3-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1"></a><span class="n">agent</span><span class="o">.</span><span class="n">model</span>
</code></pre></div></td></tr></table></div>
<p>text:</p>
<div class="language-text highlight"><pre><span></span><code>RunnableBinding(bound=ChatOpenAI(client=&lt;openai.resources.chat.completions.completions.Completions object at 0x10cd3c080&gt;, async_client=&lt;openai.resources.chat.completions.completions.AsyncCompletions object at 0x10cd3dd90&gt;, root_client=&lt;openai.OpenAI object at 0x10844b6e0&gt;, root_async_client=&lt;openai.AsyncOpenAI object at 0x10cd3c0e0&gt;, model_name=&#39;gpt-4o-mini&#39;, model_kwargs={}, openai_api_key=SecretStr(&#39;**********&#39;)), kwargs={&#39;tools&#39;: [{&#39;type&#39;: &#39;function&#39;, &#39;function&#39;: {&#39;name&#39;: &#39;check_new_messages&#39;, &#39;description&#39;: &#39;Check messages.&#39;, &#39;parameters&#39;: {&#39;properties&#39;: {}, &#39;type&#39;: &#39;object&#39;}}}]}, config={}, config_factories=[])
</code></pre></div>
<hr />
<p>You can also use the method <code>get_model_with_tools</code> to get the tool-bound model with any additional tools. The <code>invoke</code>, <code>stream</code>, <code>chat</code>, and <code>chat_stream</code> methods all use this under-the hood so you can add any tools, toolkits, or tool factories to the model at invokation.</p>
<hr />
<div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-4-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1"></a><span class="n">agent</span><span class="o">.</span><span class="n">get_model_with_tools</span><span class="p">(</span><span class="n">tools</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
<p>text:</p>
<div class="language-text highlight"><pre><span></span><code>(RunnableBinding(bound=ChatOpenAI(client=&lt;openai.resources.chat.completions.completions.Completions object at 0x10cd3c080&gt;, async_client=&lt;openai.resources.chat.completions.completions.AsyncCompletions object at 0x10cd3dd90&gt;, root_client=&lt;openai.OpenAI object at 0x10844b6e0&gt;, root_async_client=&lt;openai.AsyncOpenAI object at 0x10cd3c0e0&gt;, model_name=&#39;gpt-4o-mini&#39;, model_kwargs={}, openai_api_key=SecretStr(&#39;**********&#39;)), kwargs={&#39;tools&#39;: [{&#39;type&#39;: &#39;function&#39;, &#39;function&#39;: {&#39;name&#39;: &#39;check_new_messages&#39;, &#39;description&#39;: &#39;Check messages.&#39;, &#39;parameters&#39;: {&#39;properties&#39;: {}, &#39;type&#39;: &#39;object&#39;}}}]}, config={}, config_factories=[]),
 ToolLookup(tools={&#39;check_new_messages&#39;: StructuredTool(name=&#39;check_new_messages&#39;, description=&#39;Check messages.&#39;, args_schema=&lt;class &#39;langchain_core.utils.pydantic.check_new_messages&#39;&gt;, func=&lt;function check_new_messages at 0x1084516c0&gt;)}))
</code></pre></div>
<hr />
<p>Tools will be automatically used when we call any of the invoke or stream methods.</p>
<p>Notice that the LLM behaves normally if the user's prompts are unrelated to the tool.</p>
<hr />
<div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-5-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1"></a><span class="n">agent</span><span class="o">.</span><span class="n">_invoke</span><span class="p">(</span><span class="s1">&#39;Hello world!&#39;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
<p>text:</p>
<div class="language-text highlight"><pre><span></span><code>ChatResult(content=Hello! How can I assist you today?, tool_calls=[])
</code></pre></div>
<hr />
<p>If the LLM "decides" that the user needs to execute a tool, it returns a tool call as the response instead of returning content.</p>
<hr />
<div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-6-1">1</a></span>
<span class="normal"><a href="#__codelineno-6-2">2</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-6-1" name="__codelineno-6-1"></a><span class="n">result</span> <span class="o">=</span> <span class="n">agent</span><span class="o">.</span><span class="n">_invoke</span><span class="p">(</span><span class="s1">&#39;Check my messages.&#39;</span><span class="p">)</span>
<a id="__codelineno-6-2" name="__codelineno-6-2"></a><span class="n">result</span>
</code></pre></div></td></tr></table></div>
<p>text:</p>
<div class="language-text highlight"><pre><span></span><code>ChatResult(content=, tool_calls=[ToolCallInfo(id=&#39;call_D0WyCNzn8Hg0qRxsui24aZ33&#39;, name=&#39;check_new_messages&#39;, type=&#39;tool_call&#39;, args={}, tool=StructuredTool(name=&#39;check_new_messages&#39;, description=&#39;Check messages.&#39;, args_schema=&lt;class &#39;langchain_core.utils.pydantic.check_new_messages&#39;&gt;, func=&lt;function check_new_messages at 0x1084516c0&gt;))])
</code></pre></div>
<hr />
<p>The tool call information can be accessed through the <code>ChatResult.tool_calls</code> attribute, which is simply a list supertype. Use <code>tool_info_str</code> to clearly show the arguments being passed to the function.</p>
<hr />
<div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-7-1">1</a></span>
<span class="normal"><a href="#__codelineno-7-2">2</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-7-1" name="__codelineno-7-1"></a><span class="k">for</span> <span class="n">tc</span> <span class="ow">in</span> <span class="n">result</span><span class="o">.</span><span class="n">tool_calls</span><span class="p">:</span>
<a id="__codelineno-7-2" name="__codelineno-7-2"></a>    <span class="nb">print</span><span class="p">(</span><span class="n">tc</span><span class="o">.</span><span class="n">tool_info_str</span><span class="p">())</span>
</code></pre></div></td></tr></table></div>
<p>stdout:</p>
<div class="language-text highlight"><pre><span></span><code>check_new_messages()
</code></pre></div>
<hr />
<p>You may also provide additional tools at the time of invoking the LLM, and it will be treated as if it was part of the chatbot. </p>
<p>In this example, we create a new tool with two arguments that must be provided by the LLM.</p>
<hr />
<div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-8-1">1</a></span>
<span class="normal"><a href="#__codelineno-8-2">2</a></span>
<span class="normal"><a href="#__codelineno-8-3">3</a></span>
<span class="normal"><a href="#__codelineno-8-4">4</a></span>
<span class="normal"><a href="#__codelineno-8-5">5</a></span>
<span class="normal"><a href="#__codelineno-8-6">6</a></span>
<span class="normal"><a href="#__codelineno-8-7">7</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-8-1" name="__codelineno-8-1"></a><span class="nd">@langchain_core</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">tool</span>
<a id="__codelineno-8-2" name="__codelineno-8-2"></a><span class="k">def</span> <span class="nf">send_message</span><span class="p">(</span><span class="n">recipient</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">text</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-8-3" name="__codelineno-8-3"></a><span class="w">    </span><span class="sd">&#39;&#39;&#39;Send messages to others.&#39;&#39;&#39;</span>
<a id="__codelineno-8-4" name="__codelineno-8-4"></a>    <span class="k">return</span> <span class="sa">f</span><span class="s1">&#39;Message sent!&#39;</span>
<a id="__codelineno-8-5" name="__codelineno-8-5"></a>
<a id="__codelineno-8-6" name="__codelineno-8-6"></a><span class="n">result</span> <span class="o">=</span> <span class="n">agent</span><span class="o">.</span><span class="n">_invoke</span><span class="p">(</span><span class="s1">&#39;Send a message to Bob saying &quot;Hello!&quot;&#39;</span><span class="p">,</span> <span class="n">tools</span><span class="o">=</span><span class="p">[</span><span class="n">send_message</span><span class="p">])</span>
<a id="__codelineno-8-7" name="__codelineno-8-7"></a><span class="n">result</span>
</code></pre></div></td></tr></table></div>
<p>text:</p>
<div class="language-text highlight"><pre><span></span><code>ChatResult(content=, tool_calls=[ToolCallInfo(id=&#39;call_CaZgudgmby8bQahiyL2PnP6J&#39;, name=&#39;send_message&#39;, type=&#39;tool_call&#39;, args={&#39;recipient&#39;: &#39;Bob&#39;, &#39;text&#39;: &#39;Hello!&#39;}, tool=StructuredTool(name=&#39;send_message&#39;, description=&#39;Send messages to others.&#39;, args_schema=&lt;class &#39;langchain_core.utils.pydantic.send_message&#39;&gt;, func=&lt;function send_message at 0x10cd45a80&gt;))])
</code></pre></div>
<hr />
<p>You can see that the LLM provided the <code>recipient</code> and <code>text</code> arguments which were passed to the function call information.</p>
<hr />
<div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-9-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-9-1" name="__codelineno-9-1"></a><span class="n">result</span><span class="o">.</span><span class="n">tool_calls</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">tool_info_str</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
<p>text:</p>
<div class="language-text highlight"><pre><span></span><code>&#39;send_message(recipient=Bob, text=Hello!)&#39;
</code></pre></div>
<hr />
<p>You can adjust behavior using the <code>tool_choice</code> argument in the chatbot constructor or at invokation. The value <code>'any'</code> means that a tool MUST be called, but all tools are candidates. The value <code>'auto'</code> (the default) allows the LLM to reply with normal content rather than a tool call, and you can also pass the name of a specific function as well.</p>
<hr />
<div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-10-1">1</a></span>
<span class="normal"><a href="#__codelineno-10-2">2</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-10-1" name="__codelineno-10-1"></a><span class="n">result</span> <span class="o">=</span> <span class="n">agent</span><span class="o">.</span><span class="n">_invoke</span><span class="p">(</span><span class="s1">&#39;Go to the store for me!&#39;</span><span class="p">,</span> <span class="n">tool_choice</span><span class="o">=</span><span class="s1">&#39;any&#39;</span><span class="p">)</span>
<a id="__codelineno-10-2" name="__codelineno-10-2"></a><span class="n">result</span><span class="o">.</span><span class="n">tool_calls</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">tool_info_str</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
<p>text:</p>
<div class="language-text highlight"><pre><span></span><code>&#39;check_new_messages()&#39;
</code></pre></div>
<hr />
<h2 id="executing-tools">Executing Tools</h2>
<p>Tools allow the LLM to determine if and when to execute tools and also provides parameters for the tool call based on conversation history, but the user containing function is responsible for actually executing the tool with the arguments from the LLM.</p>
<p>Use the <code>execute_tools</code> method to actually execute the tool, which returns a mapping of tool names to <code>ToolCallResult</code> objects.</p>
<hr />
<div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-11-1">1</a></span>
<span class="normal"><a href="#__codelineno-11-2">2</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-11-1" name="__codelineno-11-1"></a><span class="n">result</span> <span class="o">=</span> <span class="n">agent</span><span class="o">.</span><span class="n">_invoke</span><span class="p">(</span><span class="s1">&#39;Check my messages.&#39;</span><span class="p">)</span>
<a id="__codelineno-11-2" name="__codelineno-11-2"></a><span class="n">result</span><span class="o">.</span><span class="n">tool_calls</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">tool_info_str</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
<p>text:</p>
<div class="language-text highlight"><pre><span></span><code>&#39;check_new_messages()&#39;
</code></pre></div>
<hr />
<hr />
<div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-12-1">1</a></span>
<span class="normal"><a href="#__codelineno-12-2">2</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-12-1" name="__codelineno-12-1"></a><span class="n">tr</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">execute_tools</span><span class="p">()</span>
<a id="__codelineno-12-2" name="__codelineno-12-2"></a><span class="n">tr</span>
</code></pre></div></td></tr></table></div>
<p>text:</p>
<div class="language-text highlight"><pre><span></span><code>{&#39;check_new_messages&#39;: ToolCallResult(info=ToolCallInfo(id=&#39;call_CPyijbPQpk91FIdl0B8NOLmI&#39;, name=&#39;check_new_messages&#39;, type=&#39;tool_call&#39;, args={}, tool=StructuredTool(name=&#39;check_new_messages&#39;, description=&#39;Check messages.&#39;, args_schema=&lt;class &#39;langchain_core.utils.pydantic.check_new_messages&#39;&gt;, func=&lt;function check_new_messages at 0x1084516c0&gt;)), return_value=&#39;No new messages.&#39;)}
</code></pre></div>
<hr />
<p>Get the return value from the tool through the <code>return_value</code> property.</p>
<hr />
<div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-13-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-13-1" name="__codelineno-13-1"></a><span class="n">tr</span><span class="p">[</span><span class="s1">&#39;check_new_messages&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">return_value</span>
</code></pre></div></td></tr></table></div>
<p>text:</p>
<div class="language-text highlight"><pre><span></span><code>&#39;No new messages.&#39;
</code></pre></div>
<hr />
<p>Extracting tool calls from a <code>StreamResult</code> is a little more complicated because the stream must be exhausted before executing tools. This happens because the tool call information replaces the text response, so the streamer is essentially receiving chunks of the function call information until exhaustion.</p>
<p>The calling function must handle both the streamed output and tool calls.</p>
<hr />
<div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-14-1">1</a></span>
<span class="normal"><a href="#__codelineno-14-2">2</a></span>
<span class="normal"><a href="#__codelineno-14-3">3</a></span>
<span class="normal"><a href="#__codelineno-14-4">4</a></span>
<span class="normal"><a href="#__codelineno-14-5">5</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-14-1" name="__codelineno-14-1"></a><span class="n">stream</span> <span class="o">=</span> <span class="n">agent</span><span class="o">.</span><span class="n">_stream</span><span class="p">(</span><span class="s1">&#39;Check my messages.&#39;</span><span class="p">)</span>
<a id="__codelineno-14-2" name="__codelineno-14-2"></a><span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">stream</span><span class="p">:</span>
<a id="__codelineno-14-3" name="__codelineno-14-3"></a>    <span class="nb">print</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">flush</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-14-4" name="__codelineno-14-4"></a><span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">stream</span><span class="o">.</span><span class="n">tool_calls</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-14-5" name="__codelineno-14-5"></a>    <span class="n">stream</span><span class="o">.</span><span class="n">execute_tools</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
<p>stdout:</p>
<div class="language-text highlight"><pre><span></span><code>content=&#39;&#39; additional_kwargs={&#39;tool_calls&#39;: [{&#39;index&#39;: 0, &#39;id&#39;: &#39;call_0I3oV4MeoavXZe8gyJygHkQZ&#39;, &#39;function&#39;: {&#39;arguments&#39;: &#39;&#39;, &#39;name&#39;: &#39;check_new_messages&#39;}, &#39;type&#39;: &#39;function&#39;}]} response_metadata={} id=&#39;run-029ed68d-e9ad-4a1f-9716-960302d7c64b&#39; tool_calls=[{&#39;name&#39;: &#39;check_new_messages&#39;, &#39;args&#39;: {}, &#39;id&#39;: &#39;call_0I3oV4MeoavXZe8gyJygHkQZ&#39;, &#39;type&#39;: &#39;tool_call&#39;}] tool_call_chunks=[{&#39;name&#39;: &#39;check_new_messages&#39;, &#39;args&#39;: &#39;&#39;, &#39;id&#39;: &#39;call_0I3oV4MeoavXZe8gyJygHkQZ&#39;, &#39;index&#39;: 0, &#39;type&#39;: &#39;tool_call_chunk&#39;}]content=&#39;&#39; additional_kwargs={&#39;tool_calls&#39;: [{&#39;index&#39;: 0, &#39;id&#39;: None, &#39;function&#39;: {&#39;arguments&#39;: &#39;{}&#39;, &#39;name&#39;: None}, &#39;type&#39;: None}]} response_metadata={} id=&#39;run-029ed68d-e9ad-4a1f-9716-960302d7c64b&#39; tool_calls=[{&#39;name&#39;: &#39;&#39;, &#39;args&#39;: {}, &#39;id&#39;: None, &#39;type&#39;: &#39;tool_call&#39;}] tool_call_chunks=[{&#39;name&#39;: None, &#39;args&#39;: &#39;{}&#39;, &#39;id&#39;: None, &#39;index&#39;: 0, &#39;type&#39;: &#39;tool_call_chunk&#39;}]content=&#39;&#39; additional_kwargs={} response_metadata={&#39;finish_reason&#39;: &#39;tool_calls&#39;, &#39;model_name&#39;: &#39;gpt-4o-mini-2024-07-18&#39;, &#39;system_fingerprint&#39;: &#39;fp_06737a9306&#39;} id=&#39;run-029ed68d-e9ad-4a1f-9716-960302d7c64b&#39;
</code></pre></div>
<hr />
<p>A <code>ValueError</code> will be raised if the caller tries to execute tools before the stream is exhausted.</p>
<hr />
<div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-15-1">1</a></span>
<span class="normal"><a href="#__codelineno-15-2">2</a></span>
<span class="normal"><a href="#__codelineno-15-3">3</a></span>
<span class="normal"><a href="#__codelineno-15-4">4</a></span>
<span class="normal"><a href="#__codelineno-15-5">5</a></span>
<span class="normal"><a href="#__codelineno-15-6">6</a></span>
<span class="normal"><a href="#__codelineno-15-7">7</a></span>
<span class="normal"><a href="#__codelineno-15-8">8</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-15-1" name="__codelineno-15-1"></a><span class="n">stream</span> <span class="o">=</span> <span class="n">agent</span><span class="o">.</span><span class="n">stream</span><span class="p">(</span><span class="s1">&#39;Check my messages.&#39;</span><span class="p">)</span>
<a id="__codelineno-15-2" name="__codelineno-15-2"></a><span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">stream</span><span class="p">:</span>
<a id="__codelineno-15-3" name="__codelineno-15-3"></a>    <span class="nb">print</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">content</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">flush</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-15-4" name="__codelineno-15-4"></a>    <span class="k">break</span>
<a id="__codelineno-15-5" name="__codelineno-15-5"></a><span class="k">try</span><span class="p">:</span>
<a id="__codelineno-15-6" name="__codelineno-15-6"></a>    <span class="n">stream</span><span class="o">.</span><span class="n">execute_tools</span><span class="p">()</span>
<a id="__codelineno-15-7" name="__codelineno-15-7"></a><span class="k">except</span> <span class="ne">ValueError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
<a id="__codelineno-15-8" name="__codelineno-15-8"></a>    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Exception was caught!&#39;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
<p>stdout:</p>
<div class="language-text highlight"><pre><span></span><code>Exception was caught!
</code></pre></div>
<hr />
<h2 id="toolkits-and-tool-factories">Toolkits and Tool Factories</h2>
<p>Aside from providing a list of tools, you may also bind tools from toolkits and tool factories.</p>
<ul>
<li>
<p><code>ToolKit</code>: class with a <code>get_tools() -&gt; list[BaseTool]</code> method. <code>ToolKit</code>s are part of the langchain interface, and the built-in tools often come as a subtype. Passed through the <code>toolkits: list[BaseToolkit]</code> argument.</p>
</li>
<li>
<p><strong><em>Tool Factories</em></strong>: functions that accept a chatbot as an argument and return tools. Useful when writing tools that interact with the original LLM because otherwise it would require partial initialization. Passed through the <code>tool_factories: ToolFactoryType</code> argument.</p>
</li>
</ul>
<p>Note that these too may be provided at instantiation or at invokation.</p>
<h4 id="toolkit-example"><code>ToolKit</code> Example</h4>
<p>In this example, I enable the built-in Langchain <code>FileManagementToolkit</code> toolkit to allow the chatbot to list, read, and write files.</p>
<hr />
<div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-16-1">1</a></span>
<span class="normal"><a href="#__codelineno-16-2">2</a></span>
<span class="normal"><a href="#__codelineno-16-3">3</a></span>
<span class="normal"><a href="#__codelineno-16-4">4</a></span>
<span class="normal"><a href="#__codelineno-16-5">5</a></span>
<span class="normal"><a href="#__codelineno-16-6">6</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-16-1" name="__codelineno-16-1"></a><span class="kn">import</span> <span class="nn">tempfile</span>
<a id="__codelineno-16-2" name="__codelineno-16-2"></a><span class="kn">from</span> <span class="nn">langchain_community.agent_toolkits</span> <span class="kn">import</span> <span class="n">FileManagementToolkit</span>
<a id="__codelineno-16-3" name="__codelineno-16-3"></a><span class="k">with</span> <span class="n">tempfile</span><span class="o">.</span><span class="n">TemporaryDirectory</span><span class="p">()</span> <span class="k">as</span> <span class="n">wd</span><span class="p">:</span>
<a id="__codelineno-16-4" name="__codelineno-16-4"></a>    <span class="n">file_tk</span> <span class="o">=</span> <span class="n">FileManagementToolkit</span><span class="p">(</span><span class="n">root_dir</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">wd</span><span class="p">))</span>
<a id="__codelineno-16-5" name="__codelineno-16-5"></a>    <span class="n">result</span> <span class="o">=</span> <span class="n">agent</span><span class="o">.</span><span class="n">_invoke</span><span class="p">(</span><span class="s1">&#39;List the files in this directory.&#39;</span><span class="p">,</span> <span class="n">toolkits</span><span class="o">=</span><span class="p">[</span><span class="n">file_tk</span><span class="p">])</span>
<a id="__codelineno-16-6" name="__codelineno-16-6"></a>    <span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">tool_calls</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">tool_info_str</span><span class="p">())</span>
</code></pre></div></td></tr></table></div>
<p>stdout:</p>
<div class="language-text highlight"><pre><span></span><code>list_directory()
</code></pre></div>
<hr />
<h4 id="tool-factory-examples">Tool Factory Examples</h4>
<p>Now I create a tool factory that can be passed to the chatbot. This tool uses the chatbot reference to invoke the LLM with access to all of the same tools.</p>
<hr />
<div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-17-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-17-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-17-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-17-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-17-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-17-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-17-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-17-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-17-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-17-10">10</a></span>
<span class="normal"><a href="#__codelineno-17-11">11</a></span>
<span class="normal"><a href="#__codelineno-17-12">12</a></span>
<span class="normal"><a href="#__codelineno-17-13">13</a></span>
<span class="normal"><a href="#__codelineno-17-14">14</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-17-1" name="__codelineno-17-1"></a><span class="k">def</span> <span class="nf">my_tool_factory</span><span class="p">(</span><span class="n">agent</span><span class="p">:</span> <span class="n">simplechatbot</span><span class="o">.</span><span class="n">Agent</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">langchain_core</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">Tool</span><span class="p">]:</span>
<a id="__codelineno-17-2" name="__codelineno-17-2"></a>    <span class="nd">@langchain_core</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">tool</span>
<a id="__codelineno-17-3" name="__codelineno-17-3"></a>    <span class="k">def</span> <span class="nf">story_generator</span><span class="p">(</span><span class="n">topic</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-17-4" name="__codelineno-17-4"></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;Generate a story absed on a particular topic.&#39;&#39;&#39;</span>
<a id="__codelineno-17-5" name="__codelineno-17-5"></a>        <span class="n">result</span> <span class="o">=</span> <span class="n">agent</span><span class="o">.</span><span class="n">_invoke</span><span class="p">(</span>
<a id="__codelineno-17-6" name="__codelineno-17-6"></a>            <span class="sa">f</span><span class="s1">&#39;Generate a story about </span><span class="si">{</span><span class="n">topic</span><span class="si">}</span><span class="s1">. Your response should only include the text of the story and make it short but engaging.&#39;</span><span class="p">,</span>
<a id="__codelineno-17-7" name="__codelineno-17-7"></a>        <span class="p">)</span>
<a id="__codelineno-17-8" name="__codelineno-17-8"></a>        <span class="k">return</span> <span class="n">result</span><span class="o">.</span><span class="n">content</span>
<a id="__codelineno-17-9" name="__codelineno-17-9"></a>
<a id="__codelineno-17-10" name="__codelineno-17-10"></a>    <span class="k">return</span> <span class="p">[</span><span class="n">story_generator</span><span class="p">]</span>
<a id="__codelineno-17-11" name="__codelineno-17-11"></a>
<a id="__codelineno-17-12" name="__codelineno-17-12"></a><span class="n">result</span> <span class="o">=</span> <span class="n">agent</span><span class="o">.</span><span class="n">_invoke</span><span class="p">(</span><span class="s1">&#39;Generate a story about western cowboys.&#39;</span><span class="p">,</span> <span class="n">tool_factories</span><span class="o">=</span><span class="p">[</span><span class="n">my_tool_factory</span><span class="p">])</span>
<a id="__codelineno-17-13" name="__codelineno-17-13"></a><span class="n">tc_result</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">execute_tools</span><span class="p">()</span>
<a id="__codelineno-17-14" name="__codelineno-17-14"></a><span class="n">tc_result</span><span class="p">[</span><span class="s1">&#39;story_generator&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">return_value</span>
</code></pre></div></td></tr></table></div>
<p>text:</p>
<div class="language-text highlight"><pre><span></span><code>&#39;In the heart of the rugged Wild West, a small town called Dusty Springs thrived under the watchful eyes of the surrounding mesas. The sun blazed overhead, casting long shadows over the dusty streets where only a handful of souls dared to tread. Among them was Colt Harper, a seasoned cowboy known for his swift draw and uncanny ability to ride like the wind.\n\nOne sweltering afternoon, a mysterious stranger rode into town on a sleek black stallion. Cloaked in a dust-covered duster and a wide-brimmed hat that obscured his face, he dismounted at the saloon, causing the townsfolk to whisper in hushed tones. Colt, nursing a whiskey at the bar, felt a stirring in his gut; trouble had a way of finding him.\n\nThe stranger, known only as Jake, challenged Colt to a duel at high noon. Rumors swirled that Jake was looking for revenge against Colts brother, who had long since met his fate in a gunfight gone wrong. As the clock ticked towards noon, the townspeople gathered, tension crackling in the air like a summer storm.\n\nColt strode into the street, his boots kicking up dust as he faced Jake under the blazing sun. The world around them faded away, each heartbeat echoing in the silence. With a quick draw, Colt aimed and fired, the bullet whistling through the air and finding its mark. Jake fell, surprise blossoming on his face, and the whispering crowd gasped.\n\nAs the dust settled, Colt walked over to him. This aint no way to settle a score, he said, his voice steady. Lets put the past to rest. Lifes too short. Jake nodded slowly, his anger replaced by a flicker of understanding.\n\nThe two men stood, embodying a spirit of camaraderie that echoed through the rugged landscape. Dusty Springs would remember that day not just for the gunfight, but for the moment a cowboy chose peace over vengeance. As the sun dipped below the horizon, Colt tipped his hat and rode off into the golden glow, a true gunslinger of the West.&#39;
</code></pre></div>
<hr />
<h2 id="conclusions">Conclusions</h2>
<p>That is all! Now you know how to enable and disable tools that your LLM can use to do anything!</p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["content.code.copy", "navigation.expand", "content.code.annotate"], "search": "../../assets/javascripts/workers/search.6ce7567c.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.525ec568.min.js"></script>
      
    
  </body>
</html>